(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4736d9f6","chunk-60587374","chunk-2d2218e1"],{"1f34":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("d2-container",{class:{"page-compact":e.crud.pageOptions.compact}},[r("d2-crud-x",e._g(e._b({ref:"d2Crud",attrs:{"crud.options.tableType":"vxe-table"},on:{resetPwd:e.resetPwd}},"d2-crud-x",e._crudProps,!1),e._crudListeners),[r("div",{attrs:{slot:"header"},slot:"header"},[r("crud-search",{ref:"search",attrs:{options:e.crud.searchOptions},on:{submit:e.handleSearch}}),r("el-button-group",[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"Create",expression:"'Create'"}],attrs:{size:"small",type:"primary"},on:{click:e.addRow}},[r("i",{staticClass:"el-icon-plus"}),e._v(" 新增")])],1),r("crud-toolbar",{attrs:{search:e.crud.searchOptions.show,compact:e.crud.pageOptions.compact,columns:e.crud.columns},on:{"update:search":function(t){return e.$set(e.crud.searchOptions,"show",t)},"update:compact":function(t){return e.$set(e.crud.pageOptions,"compact",t)},refresh:function(t){return e.doRefresh()},"columns-filter-changed":e.handleColumnsFilterChanged}})],1)]),r("el-dialog",{attrs:{title:"密码重置",visible:e.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"resetPwdForm",attrs:{model:e.resetPwdForm,rules:e.passwordRules}},[r("el-form-item",{attrs:{label:"密码",prop:"pwd"}},[r("el-input",{attrs:{type:"password","show-password":"",clearable:"",autocomplete:"off"},model:{value:e.resetPwdForm.pwd,callback:function(t){e.$set(e.resetPwdForm,"pwd",t)},expression:"resetPwdForm.pwd"}})],1),r("el-form-item",{attrs:{label:"再次输入密码",prop:"pwd2"}},[r("el-input",{attrs:{type:"password","show-password":"",clearable:"",autocomplete:"off"},model:{value:e.resetPwdForm.pwd2,callback:function(t){e.$set(e.resetPwdForm,"pwd2",t)},expression:"resetPwdForm.pwd2"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.resetPwdSubmit}},[e._v("确 定")])],1)],1)],1)},n=[],s=(r("4d63"),r("c607"),r("ac1f"),r("2c3e"),r("25f0"),r("d9e2"),r("00b4"),r("cb9e")),o=r("ba88"),i=r("1fbf"),l={name:"user",mixins:[i["d2CrudPlus"].crud],data:function(){var e=this,t=function(t,r,a){var n=new RegExp("(?=.*[0-9])(?=.*[a-zA-Z]).{8,30}");""===r?a(new Error("请输入密码")):n.test(r)?(""!==e.resetPwdForm.pwd2&&e.$refs.resetPwdForm.validateField("pwd2"),a()):a(new Error("您的密码复杂度太低(密码中必须包含字母、数字)"))},r=function(t,r,a){""===r?a(new Error("请再次输入密码")):r!==e.resetPwdForm.pwd?a(new Error("两次输入密码不一致!")):a()};return{dialogFormVisible:!1,resetPwdForm:{id:null,pwd:null,pwd2:null},passwordRules:{pwd:[{required:!0,message:"必填项"},{validator:t,trigger:"blur"}],pwd2:[{required:!0,message:"必填项"},{validator:r,trigger:"blur"}]}}},methods:{getCrudOptions:function(){return Object(o["crudOptions"])(this)},pageRequest:function(e){return s["GetList"](e)},addRequest:function(e){return s["AddObj"](e)},updateRequest:function(e){return s["UpdateObj"](e)},delRequest:function(e){return s["DelObj"](e.id)},resetPwd:function(e){var t=e.row;this.dialogFormVisible=!0,this.resetPwdForm.id=t.id},resetPwdSubmit:function(){var e=this;e.$refs.resetPwdForm.validate((function(t){if(t){var r={id:e.resetPwdForm.id,newPassword:e.$md5(e.resetPwdForm.pwd),newPassword2:e.$md5(e.resetPwdForm.pwd2)};s["ResetPwd"](r).then((function(t){e.dialogFormVisible=!1,e.resetPwdForm={id:null,pwd:null,pwd2:null},e.$message.success("修改成功")}))}else e.$message.error("表单校验失败，请检查")}))}}},d=l,u=(r("9898"),r("2877")),c=Object(u["a"])(d,a,n,!1,null,null,null);t["default"]=c.exports},5026:function(e,t,r){},9898:function(e,t,r){"use strict";r("5026")},ab1d:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return i}));r("d81d");var a={1:"success",true:"success",0:"danger",false:"danger",Search:"warning",Update:"primary",Create:"success",Retrieve:"info",Delete:"danger"};function n(e){return e.map((function(e){return{label:e.label,value:e.value,color:a[e.value]}}))}var s=n([{label:"启用",value:!0},{label:"禁用",value:!1}]),o=n([{label:"启用",value:1},{label:"禁用",value:0}]),i=(n([{label:"是",value:1},{label:"否",value:0}]),n([{label:"是",value:!0},{label:"否",value:!1}]))},ba88:function(e,t,r){"use strict";r.r(t),r.d(t,"crudOptions",(function(){return l}));r("99af"),r("d9e2");var a=r("22ce"),n=r("ab1d"),s=r("9668"),o=r("c276"),i=o["a"].baseURL()+"api/system/file/",l=function(e){return{pageOptions:{compact:!0},options:{height:"100%"},rowHandle:{fixed:"right",width:180,view:{thin:!0,text:"",disabled:function(){return!e.hasPermissions("Retrieve")}},edit:{thin:!0,text:"",disabled:function(){return!e.hasPermissions("Update")}},remove:{thin:!0,text:"",disabled:function(){return!e.hasPermissions("Delete")}},custom:[{thin:!0,text:"",size:"small",type:"warning",icon:"el-icon-refresh-left",show:function(){return e.hasPermissions("ResetPwd")},emit:"resetPwd"}]},viewOptions:{componentType:"form"},formOptions:{defaultSpan:12},indexRow:{title:"序号",align:"center",width:70},columns:[{title:"关键词",key:"search",show:!1,disabled:!0,search:{disabled:!1},form:{disabled:!0,component:{placeholder:"请输入关键词"}},view:{disabled:!0}},{title:"ID",key:"id",width:90,disabled:!0,form:{disabled:!0}},{title:"账号",key:"username",search:{disabled:!1},width:140,type:"input",form:{rules:[{required:!0,message:"账号必填项"}],component:{placeholder:"请输入账号"},itemProps:{class:{yxtInput:!0}},helper:{render:function(e){return e("el-alert",{attrs:{title:"密码默认为:admin123456",type:"warning"}})}}}},{title:"姓名",key:"name",search:{disabled:!1},type:"input",form:{rules:[{required:!0,message:"姓名必填项"}],component:{span:12,placeholder:"请输入姓名"},itemProps:{class:{yxtInput:!0}}}},{title:"部门",key:"dept",search:{disabled:!0},minWidth:140,type:"table-selector",dict:{cache:!1,url:s["urlPrefix"],value:"id",label:"name",getData:function(e,t,r){r.form;var n=r.component;return Object(a["c"])({url:e,params:{page:1,limit:10,status:1}}).then((function(e){return n._elProps.page=e.data.page,n._elProps.limit=e.data.limit,n._elProps.total=e.data.total,e.data.data}))}},form:{rules:[{required:!0,message:"必填项"}],itemProps:{class:{yxtInput:!0}},component:{span:12,props:{multiple:!1},elProps:{pagination:!0,columns:[{field:"name",title:"部门名称"},{field:"status_label",title:"状态"},{field:"parent_name",title:"父级部门"}]}}}},{title:"手机号码",key:"mobile",search:{disabled:!0},minWidth:110,type:"input",form:{rules:[{max:20,message:"请输入正确的手机号码",trigger:"blur"},{pattern:/^1[3|4|5|7|8]\d{9}$/,message:"请输入正确的手机号码"}],itemProps:{class:{yxtInput:!0}},component:{placeholder:"请输入手机号码"}}},{title:"邮箱",key:"email",minWidth:160,form:{rules:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],component:{placeholder:"请输入邮箱"}}},{title:"性别",key:"gender",type:"radio",width:70,dict:{data:[{label:"男",value:1},{label:"女",value:0}]},form:{value:1,component:{span:12}},component:{props:{color:"auto"}}},{title:"状态",key:"is_active",search:{disabled:!1},width:70,type:"radio",dict:{data:n["a"]},form:{value:!0,component:{span:12}}},{title:"头像",key:"avatar",type:"avatar-uploader",width:100,align:"left",form:{component:{props:{uploader:{action:i,headers:{Authorization:"JWT "+o["a"].cookies.get("token")},type:"form",successHandle:function(e,t){if(null===e.data||""===e.data)throw new Error("上传失败");return{url:o["a"].baseURL()+e.data.url,key:t.data.key}}},elProps:{multiple:!0,limit:5},sizeLimit:102400},span:24},helper:"限制文件大小不能超过50k"},valueResolve:function(e,t){var r=e[t.key];null!=r&&r instanceof Array&&(r.length>=0?e[t.key]=r[0]:e[t.key]=null)},component:{props:{buildUrl:function(e,t){return e&&0!==e.indexOf("http")?o["a"].baseURL()+e:e}}}},{title:"角色",key:"role",search:{disabled:!0},minWidth:130,type:"table-selector",dict:{cache:!1,url:"/api/system/role/",value:"id",label:"name",getData:function(e,t,r){r.form;var n=r.component;return Object(a["c"])({url:e,params:{page:1,limit:10}}).then((function(e){return n._elProps.page=e.data.page,n._elProps.limit=e.data.limit,n._elProps.total=e.data.total,e.data.data}))}},form:{rules:[{required:!0,message:"必填项"}],itemProps:{class:{yxtInput:!0}},component:{span:12,props:{multiple:!0},elProps:{pagination:!0,columns:[{field:"name",title:"角色名称"},{field:"key",title:"权限标识"},{field:"status_label",title:"状态"}]}}}}].concat(e.commonEndColumns({update_datetime:{showForm:!1,showTable:!1},create_datetime:{showForm:!1,showTable:!0}}))}}},cb9e:function(e,t,r){"use strict";r.r(t),r.d(t,"urlPrefix",(function(){return n})),r.d(t,"GetList",(function(){return s})),r.d(t,"AddObj",(function(){return o})),r.d(t,"UpdateObj",(function(){return i})),r.d(t,"DelObj",(function(){return l})),r.d(t,"ResetPwd",(function(){return d}));var a=r("22ce"),n="/api/system/user/";function s(e){return Object(a["c"])({url:n,method:"get",params:e})}function o(e){return Object(a["c"])({url:n,method:"post",data:e})}function i(e){return Object(a["c"])({url:n+e.id+"/",method:"put",data:e})}function l(e){return Object(a["c"])({url:n+e+"/",method:"delete",data:{id:e}})}function d(e){return Object(a["c"])({url:n+"reset_password/"+e.id+"/",method:"put",data:e})}}}]);