(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-027a1e16","chunk-c2ecf410","chunk-2d0e28c4"],{"11b3":function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticStyle:{padding:"20px"}},[l("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[l("el-form-item",{attrs:{label:"所属分组",prop:"parent"}},[l("el-select",{attrs:{placeholder:"请选择分组",clearable:""},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(e.parentOptions,(function(e,t){return l("el-option",{key:t,attrs:{label:e.title,value:e.id}})})),1)],1),l("el-form-item",{attrs:{label:"标题",prop:"title"}},[l("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),l("el-form-item",{attrs:{label:"key值",prop:"key"}},[l("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.form.key,callback:function(t){e.$set(e.form,"key",t)},expression:"form.key"}})],1),l("el-form-item",{attrs:{label:"表单类型",prop:"form_item_type"}},[l("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.form.form_item_type,callback:function(t){e.$set(e.form,"form_item_type",t)},expression:"form.form_item_type"}},e._l(e.typeOptions,(function(e,t){return l("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),[13,14].indexOf(e.form.form_item_type)>-1?l("div",[l("associationTable",{ref:"associationTable",on:{updateVal:e.associationTableUpdate},model:{value:e.form.setting,callback:function(t){e.$set(e.form,"setting",t)},expression:"form.setting"}})],1):e._e(),l("el-form-item",{attrs:{label:"校验规则"}},[l("el-select",{attrs:{multiple:"",placeholder:"请选择(可多选)",clearable:""},model:{value:e.form.rule,callback:function(t){e.$set(e.form,"rule",t)},expression:"form.rule"}},e._l(e.ruleOptions,(function(e,t){return l("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),l("el-form-item",{attrs:{label:"提示信息",prop:"placeholder"}},[l("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.form.placeholder,callback:function(t){e.$set(e.form,"placeholder",t)},expression:"form.placeholder"}})],1),l("el-form-item",{attrs:{label:"排序",prop:"sort"}},[l("el-input-number",{attrs:{min:0,max:99},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),l("el-form-item",[l("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即创建")])],1)],1)],1)},r=[],o=l("b85c"),n=(l("e9c4"),l("d3b7"),l("7ebb")),i=l("e52a"),s={name:"addContent",inject:["refreshView"],components:{associationTable:i["default"]},data:function(){return{form:{parent:null,title:null,key:null,form_item_type:null,rule:null,placeholder:null},rules:{parent:[{required:!0,message:"请选择"}],title:[{required:!0,message:"请输入"}],key:[{required:!0,message:"请输入"},{pattern:/^[A-Za-z0-9]+$/,message:"只支持字母和数字的输入"}],form_item_type:[{required:!0,message:"请输入"}]},parentOptions:[],typeOptions:[{value:0,label:"短文本"},{value:1,label:"长文本"},{value:2,label:"数字框"},{value:3,label:"选择框"},{value:4,label:"单选框"},{value:5,label:"复选框"},{value:6,label:"日期"},{value:7,label:"日期时间"},{value:8,label:"时间"},{value:9,label:"图片"},{value:10,label:"文件"},{value:11,label:"数组"},{value:12,label:"关联表"},{value:13,label:"关联表(多选)"}],ruleOptions:[{label:"必填项",value:'{"required": true, "message": "必填项不能为空"}'},{label:"邮箱",value:'{ "type": "email", "message": "请输入正确的邮箱地址"}'}]}},methods:{getParent:function(){var e=this;n["GetList"]({parent__isnull:!0,limit:999}).then((function(t){var l=t.data.data;e.parentOptions=l}))},onSubmit:function(){var e=this,t=this;t.associationTableUpdate().then((function(){var l,a=JSON.parse(JSON.stringify(t.form)),r=[],i=Object(o["a"])(a.rule);try{for(i.s();!(l=i.n()).done;){var s=l.value,u=JSON.parse(s);r.push(u)}}catch(c){i.e(c)}finally{i.f()}a.rule=r,t.$refs.form.validate((function(t){if(!t)return console.log("error submit!!"),!1;n["createObj"](a).then((function(t){e.$message.success("新增成功"),e.refreshView()}))}))}))},associationTableUpdate:function(){var e=this;return new Promise((function(t,l){if(e.$refs.associationTable){if(console.log(e.$refs.associationTable.onSubmit()),!e.$refs.associationTable.onSubmit())return l(!1);var a=e.$refs.associationTable.formObj;return e.form.setting=a,t(!0)}return t(!0)}))}},created:function(){this.getParent()}},u=s,c=l("2877"),f=Object(c["a"])(u,a,r,!1,null,"76b31abd",null);t["default"]=f.exports},"7ebb":function(e,t,l){"use strict";l.r(t),l.d(t,"urlPrefix",(function(){return r})),l.d(t,"GetList",(function(){return o})),l.d(t,"saveContent",(function(){return n})),l.d(t,"createObj",(function(){return i})),l.d(t,"UpdateObj",(function(){return s})),l.d(t,"DelObj",(function(){return u})),l.d(t,"GetAssociationTable",(function(){return c}));var a=l("22ce"),r="/api/system/system_config/";function o(e){return Object(a["c"])({url:r,method:"get",params:e})}function n(e,t){return Object(a["c"])({url:r+"save_content/",method:"put",data:t})}function i(e){return Object(a["c"])({url:r,method:"post",data:e})}function s(e){return Object(a["c"])({url:r+e.id+"/",method:"put",data:e})}function u(e){return Object(a["c"])({url:r+e+"/",method:"delete",data:{id:e}})}function c(){return Object(a["c"])({url:r+"get_association_table/",method:"get",params:{}})}},e52a:function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("el-form",{ref:"association",attrs:{model:e.formObj}},[l("el-form-item",{attrs:{label:"关联表",prop:"table",rules:[{required:!0,message:"必填项",trigger:"blur"}]}},[l("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.formObj.table,callback:function(t){e.$set(e.formObj,"table",t)},expression:"formObj.table"}},e._l(e.tableOptions,(function(t){return l("el-option",{key:t.table,attrs:{label:t.tableName,value:t.table}},[l("span",{staticStyle:{float:"left"}},[e._v(e._s(t.tableName))]),l("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.table))])])})),1)],1),l("el-form-item",{attrs:{label:"显示字段",prop:"field",rules:[{required:!0,message:"必填项",trigger:"blur"}]}},[l("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.formObj.field,callback:function(t){e.$set(e.formObj,"field",t)},expression:"formObj.field"}},e._l(e.labelOptions,(function(t){return l("el-option",{key:t.table,attrs:{label:t.title,value:t.field}},[l("span",{staticStyle:{float:"left"}},[e._v(e._s(t.field))]),l("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.title))])])})),1)],1),l("el-form-item",{attrs:{label:"储存字段",prop:"primarykey",rules:[{required:!0,message:"必填项",trigger:"blur"}]}},[l("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.formObj.primarykey,callback:function(t){e.$set(e.formObj,"primarykey",t)},expression:"formObj.primarykey"}},e._l(e.labelOptions,(function(t,a){return l("el-option",{key:a,attrs:{label:t.title,value:t.field}},[l("span",{staticStyle:{float:"left"}},[e._v(e._s(t.field))]),l("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.title))])])})),1)],1),l("el-form-item",{attrs:{label:"过滤条件",prop:"oldSearchField",rules:[{required:!0,message:"必填项",trigger:"blur"}]}},[l("el-select",{attrs:{multiple:"",filterable:"",clearable:"",placeholder:"请选择"},on:{change:e.handleSearch},model:{value:e.formObj.oldSearchField,callback:function(t){e.$set(e.formObj,"oldSearchField",t)},expression:"formObj.oldSearchField"}},e._l(e.labelOptions,(function(t,a){return l("el-option",{key:a,attrs:{label:t.title,value:t.field}},[l("span",{staticStyle:{float:"left"}},[e._v(e._s(t.field))]),l("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.title))])])})),1)],1)],1)],1)},r=[],o=(l("7db0"),l("d3b7"),l("4de4"),l("7ebb")),n={name:"associationTable",props:{value:{type:Object}},model:{prop:"value",event:"updateVal"},data:function(){return{formObj:{table:null,primarykey:null,field:null,searchField:null,oldSearchField:null},searchField:null,tableOptions:[],labelOptions:[]}},methods:{init:function(){var e=this;o["GetAssociationTable"]().then((function(t){var l=t.data;e.tableOptions=l,e.formObj.table=l[0].table,e.labelOptions=l[0].tableFields,e.formObj.primarykey="id",e.formObj.field="id"}))},handleChange:function(e){var t=this,l=t.tableOptions.find((function(t){return t.table===e})),a=l.tableFields;t.labelOptions=a},handleSearch:function(e){var t=this,l=t.labelOptions.filter((function(t){return e.indexOf(t.field)>-1}));t.formObj.searchField=l},handleUpdate:function(){this.$emit("updateVal",this.formObj)},onSubmit:function(){var e=!1;return this.$refs.association.validate((function(t){if(!t)return!1;e=!0})),e}},created:function(){this.init()}},i=n,s=l("2877"),u=Object(s["a"])(i,a,r,!1,null,"827b0c1c",null);t["default"]=u.exports}}]);